<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Sudoku Football Pro</title>
    <style>
        :root { --field: #2e7d32; --accent: #ffeb3b; --text: #ffffff; --dark: #0b1a0b; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--dark); color: white; display: flex; flex-direction: column; align-items: center; margin: 0; padding: 0; min-height: 100vh; }
        
        .header-info { text-align: center; background: #000; width: 100%; padding: 20px 0; border-bottom: 5px solid var(--accent); margin-bottom: 20px; }
        #progress-text { font-size: 2rem; font-weight: bold; color: var(--accent); text-transform: uppercase; }

        .game-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; align-items: flex-start; padding: 20px; }

        /* TABLERO GRANDE */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(6, 70px); 
            grid-template-rows: repeat(6, 70px); 
            background: #000; 
            border: 8px solid #000;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }

        .cell { 
            width: 70px; height: 70px; 
            background: var(--field); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 40px; cursor: pointer; 
            border: 1px solid rgba(0,0,0,0.2);
            box-sizing: border-box; transition: 0.2s;
        }

        /* DIVISIONES GRUESAS POR BLOQUE 2x3 */
        .cell:nth-child(3n) { border-right: 8px solid #000 !important; }
        .cell:nth-child(6n) { border-right: none !important; }
        .cell:nth-child(n+13):nth-child(-n+18), 
        .cell:nth-child(n+25):nth-child(-n+30) { border-bottom: 8px solid #000 !important; }

        .selected { background: var(--accent) !important; transform: scale(1.05); z-index: 10; box-shadow: 0 0 15px var(--accent); }
        .fixed { background: #1b5e20; cursor: default; filter: brightness(0.75); }
        .error { background: #ff4d4d !important; animation: shake 0.4s; }

        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }

        /* PANEL LATERAL DE FIGURAS */
        .sidebar { display: flex; flex-direction: column; gap: 15px; background: rgba(0,0,0,0.5); padding: 25px; border-radius: 20px; border: 2px solid var(--accent); }
        .sidebar h3 { margin: 0 0 10px 0; text-align: center; color: var(--accent); }
        .icon-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        
        .icon-btn { 
            font-size: 35px; width: 80px; height: 80px; border-radius: 15px; 
            border: 3px solid #000; background: white; cursor: pointer; 
            transition: transform 0.2s, background 0.2s;
        }
        .icon-btn:hover { transform: scale(1.1); background: var(--accent); }
        .delete-btn { grid-column: span 2; height: 50px; font-size: 18px; font-weight: bold; background: #ff4444; color: white; border: none; border-radius: 10px; cursor: pointer; }

        #victory-msg { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        .btn-next { background: var(--accent); color: #000; border: none; padding: 20px 40px; font-size: 1.5rem; font-weight: bold; border-radius: 50px; cursor: pointer; margin-top: 30px; }

        @media (max-width: 600px) {
            .grid { grid-template-columns: repeat(6, 50px); grid-template-rows: repeat(6, 50px); }
            .cell { width: 50px; height: 50px; font-size: 28px; }
            .game-container { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>

    <div class="header-info">
        <span id="progress-text">CARGANDO PARTIDO...</span>
    </div>

    <div class="game-container">
        <div class="grid" id="grid"></div>

        <div class="sidebar">
            <h3>FIGURAS</h3>
            <div class="icon-grid">
                <button class="icon-btn" onclick="put('‚öΩ')">‚öΩ</button>
                <button class="icon-btn" onclick="put('üèÜ')">üèÜ</button>
                <button class="icon-btn" onclick="put('üëï')">üëï</button>
                <button class="icon-btn" onclick="put('üì£')">üì£</button>
                <button class="icon-btn" onclick="put('üß§')">üß§</button>
                <button class="icon-btn" onclick="put('üö©')">üö©</button>
                <button class="delete-btn" onclick="put('')">BORRAR ‚ùå</button>
            </div>
        </div>
    </div>

    <div id="victory-msg">
        <h1 id="win-title" style="color: var(--accent); font-size: 4rem; margin: 0;">¬°GOLAZO!</h1>
        <p id="win-desc" style="font-size: 1.8rem;">Punto de examen conseguido.</p>
        <button class="btn-next" id="btn-action" onclick="nextLevel()">SIGUIENTE PARTIDO</button>
    </div>

    <script>
        const grid = document.getElementById('grid');
        let selected = null;
        let currentLevelIndex = 0;
        let totalScore = 0;
        const icons = { 1:'‚öΩ', 2:'üèÜ', 3:'üëï', 4:'üì£', 5:'üß§', 6:'üö©' };

        const niveles = [
            [ [1,0,0,0,5,0],[0,0,6,0,0,1],[0,1,0,2,0,0],[0,0,4,0,1,0],[6,0,0,3,0,0],[0,4,0,0,0,2] ],
            [ [0,2,0,4,0,0],[1,0,0,0,6,0],[0,0,2,0,0,5],[6,0,0,1,0,0],[0,3,0,0,0,2],[0,0,5,0,3,0] ],
            [ [0,0,4,0,0,6],[3,0,0,1,0,0],[0,5,0,0,2,0],[0,1,0,0,6,0],[0,0,2,0,0,5],[6,0,0,3,0,0] ],
            [ [5,0,0,2,0,0],[0,1,0,0,3,0],[0,0,3,0,0,1],[6,0,0,4,0,0],[0,4,0,0,2,0],[0,0,1,0,0,6] ],
            [ [0,6,0,0,4,0],[0,0,1,5,0,0],[3,0,0,0,0,2],[5,0,0,0,0,4],[0,0,2,6,0,0],[0,4,0,0,1,0] ],
            [ [2,0,5,0,0,1],[0,0,0,3,0,0],[0,4,0,0,6,0],[0,6,0,0,2,0],[0,0,3,0,0,0],[4,0,0,5,0,3] ]
        ];

        niveles.sort(() => Math.random() - 0.5);

        function loadLevel() {
            grid.innerHTML = '';
            document.getElementById('progress-text').innerText = `PARTIDO ${currentLevelIndex + 1} DE 5`;
            const layout = niveles[currentLevelIndex];
            layout.forEach((row, r) => {
                row.forEach((val, c) => {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.r = r; cell.dataset.c = c;
                    if (val !== 0) {
                        cell.innerText = icons[val];
                        cell.classList.add('fixed');
                    } else {
                        cell.onclick = () => {
                            document.querySelectorAll('.cell').forEach(cl => cl.classList.remove('selected'));
                            selected = cell; cell.classList.add('selected');
                        };
                    }
                    grid.appendChild(cell);
                });
            });
        }

        function put(emoji) {
            if (selected && !selected.classList.contains('fixed')) {
                selected.innerText = emoji;
                validate();
            }
        }

        function validate() {
            const cells = Array.from(document.querySelectorAll('.cell'));
            let hasError = false;
            let filledCount = 0;

            // Resetear errores
            cells.forEach(c => c.classList.remove('error'));

            cells.forEach(cell => {
                const val = cell.innerText;
                if (!val) return;
                filledCount++;

                const r = parseInt(cell.dataset.r);
                const c = parseInt(cell.dataset.c);

                cells.forEach(other => {
                    if (cell === other) return;
                    const or = parseInt(other.dataset.r);
                    const oc = parseInt(other.dataset.c);
                    const bR = Math.floor(r / 2), bC = Math.floor(c / 3);
                    const obR = Math.floor(or / 2), obC = Math.floor(oc / 3);

                    if (other.innerText === val) {
                        // REGLA: Fila, Columna o Bloque 2x3
                        if (or === r || oc === c || (bR === obR && bC === obC)) {
                            cell.classList.add('error');
                            hasError = true;
                        }
                    }
                });
            });

            if (filledCount === 36 && !hasError) {
                totalScore++;
                setTimeout(() => { document.getElementById('victory-msg').style.display = 'flex'; }, 300);
            }
        }

        function nextLevel() {
            if (currentLevelIndex + 1 >= 5) { location.reload(); return; }
            currentLevelIndex++;
            document.getElementById('victory-msg').style.display = 'none';
            loadLevel();
        }

        loadLevel();
    </script>
</body>
</html>
