<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen: Sudoku Football</title>
    <style>
        :root { --field: #2e7d32; --accent: #ffeb3b; --text: #ffffff; }
        body { font-family: sans-serif; background: #0b1a0b; color: white; display: flex; flex-direction: column; align-items: center; padding: 0; margin: 0; }
        
        /* Cabecera del Examen */
        .header-info { text-align: center; background: #000; width: 100%; padding: 15px 0; margin-bottom: 20px; border-bottom: 4px solid var(--accent); }
        #progress-text { font-size: 1.6rem; font-weight: bold; color: var(--accent); display: block; }

        /* Contenedor del Tablero */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(6, 52px); 
            grid-template-rows: repeat(6, 52px); 
            background: #000; 
            border: 6px solid #000; 
            box-shadow: 0 0 25px rgba(0,0,0,0.7);
        }

        .cell { 
            width: 52px; height: 52px; 
            background: var(--field); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 28px; cursor: pointer; 
            border: 1px solid rgba(255,255,255,0.2);
            box-sizing: border-box;
        }

        /* REJILLA GRUESA - DIVISIONES DE BLOQUES */
        /* Vertical: grueso tras la 3ra columna */
        .cell:nth-child(3n) { border-right: 6px solid #000 !important; }
        .cell:nth-child(6n) { border-right: none !important; }

        /* Horizontal: grueso tras la 2da y 4ta fila */
        .cell:nth-child(n+13):nth-child(-n+18), 
        .cell:nth-child(n+25):nth-child(-n+30) { 
            border-bottom: 6px solid #000 !important; 
        }

        .selected { background: var(--accent) !important; color: #000; outline: 3px solid white; z-index: 5; }
        .fixed { background: #1b5e20; cursor: default; filter: brightness(0.7); }
        .error { background: #d32f2f !important; }

        .toolbar { margin-top: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .icon-btn { font-size: 26px; width: 65px; height: 65px; border-radius: 12px; border: 2px solid #000; background: white; cursor: pointer; }
        
        #victory-msg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        .btn-next { background: var(--accent); color: #000; border: none; padding: 15px 35px; font-size: 1.3rem; font-weight: bold; border-radius: 50px; cursor: pointer; margin-top: 25px; }
    </style>
</head>
<body>

    <div class="header-info">
        <span id="progress-text">PARTIDO 1 DE 5</span>
        <div style="font-size: 0.9rem; margin-top: 5px; color: #aaa;">Resuelve para calificar</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="toolbar">
        <button class="icon-btn" onclick="put('‚öΩ')">‚öΩ</button>
        <button class="icon-btn" onclick="put('üèÜ')">üèÜ</button>
        <button class="icon-btn" onclick="put('üëï')">üëï</button>
        <button class="icon-btn" onclick="put('üì£')">üì£</button>
        <button class="icon-btn" onclick="put('üß§')">üß§</button>
        <button class="icon-btn" onclick="put('üö©')">üö©</button>
        <button class="icon-btn" style="grid-column: span 3; height: 40px; font-size: 16px;" onclick="put('')">BORRAR ‚ùå</button>
    </div>

    <div id="victory-msg">
        <h1 id="win-title" style="color: var(--accent); font-size: 3rem; margin: 0;">¬°GOL!</h1>
        <p id="win-desc" style="font-size: 1.5rem;">Punto acumulado.</p>
        <button class="btn-next" id="btn-action" onclick="nextLevel()">SIGUIENTE PARTIDO</button>
    </div>

    <script>
        const grid = document.getElementById('grid');
        let selected = null;
        let currentLevelIndex = 0;
        let totalScore = 0;
        const totalLevelsToPlay = 5;
        const icons = { 1:'‚öΩ', 2:'üèÜ', 3:'üëï', 4:'üì£', 5:'üß§', 6:'üö©' };

        const niveles = [
            [ [1,0,0,0,5,0],[0,0,6,0,0,1],[0,1,0,2,0,0],[0,0,4,0,1,0],[6,0,0,3,0,0],[0,4,0,0,0,2] ],
            [ [0,2,0,4,0,0],[1,0,0,0,6,0],[0,0,2,0,0,5],[6,0,0,1,0,0],[0,3,0,0,0,2],[0,0,5,0,3,0] ],
            [ [0,0,4,0,0,6],[3,0,0,1,0,0],[0,5,0,0,2,0],[0,1,0,0,6,0],[0,0,2,0,0,5],[6,0,0,3,0,0] ],
            [ [5,0,0,2,0,0],[0,1,0,0,3,0],[0,0,3,0,0,1],[6,0,0,4,0,0],[0,4,0,0,2,0],[0,0,1,0,0,6] ],
            [ [0,6,0,0,4,0],[0,0,1,5,0,0],[3,0,0,0,0,2],[5,0,0,0,0,4],[0,0,2,6,0,0],[0,4,0,0,1,0] ],
            [ [2,0,5,0,0,1],[0,0,0,3,0,0],[0,4,0,0,6,0],[0,6,0,0,2,0],[0,0,3,0,0,0],[4,0,0,5,0,3] ]
        ];

        niveles.sort(() => Math.random() - 0.5);

        function loadLevel() {
            grid.innerHTML = '';
            document.getElementById('progress-text').innerText = `PARTIDO ${currentLevelIndex + 1} DE 5`;
            const layout = niveles[currentLevelIndex];
            layout.forEach((row, r) => {
                row.forEach((val, c) => {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.r = r; cell.dataset.c = c;
                    if (val !== 0) {
                        cell.innerText = icons[val];
                        cell.classList.add('fixed');
                    } else {
                        cell.onclick = () => {
                            document.querySelectorAll('.cell').forEach(cl => cl.classList.remove('selected'));
                            selected = cell; cell.classList.add('selected');
                        };
                    }
                    grid.appendChild(cell);
                });
            });
        }

        function put(emoji) {
            if (selected && !selected.classList.contains('fixed')) {
                selected.innerText = emoji;
                validate();
            }
        }

        function validate() {
            const cells = Array.from(document.querySelectorAll('.cell'));
            let hasError = false;
            let isComplete = true;

            cells.forEach(cell => {
                cell.classList.remove('error');
                if (cell.innerText === "") isComplete = false;
                const val = cell.innerText;
                if (!val) return;
                const r = parseInt(cell.dataset.r);
                const c = parseInt(cell.dataset.c);
                cells.forEach(other => {
                    if (cell === other) return;
                    const or = parseInt(other.dataset.r);
                    const oc = parseInt(other.dataset.c);
                    if (other.innerText === val) {
                        if (or === r || oc === c) { cell.classList.add('error'); hasError = true; }
                        const startR = Math.floor(r / 2) * 2;
                        const startC = Math.floor(c / 3) * 3;
                        if (or >= startR && or < startR + 2 && oc >= startC && oc < startC + 3) {
                            cell.classList.add('error'); hasError = true;
                        }
                    }
                });
            });
            if (isComplete && !hasError) { totalScore++; showVictory(); }
        }

        function showVictory() {
            document.getElementById('victory-msg').style.display = 'flex';
            if (currentLevelIndex + 1 >= totalLevelsToPlay) {
                document.getElementById('win-title').innerText = "üèÜ FINAL";
                document.getElementById('win-desc').innerText = `Calificaci√≥n: ${totalScore}/5`;
                document.getElementById('btn-action').innerText = "CERRAR EXAMEN";
            }
        }

        function nextLevel() {
            if (currentLevelIndex + 1 >= totalLevelsToPlay) { location.reload(); return; }
            currentLevelIndex++;
            document.getElementById('victory-msg').style.display = 'none';
            loadLevel();
        }

        loadLevel();
    </script>
</body>
</html>
